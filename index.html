<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>maison joo — Botanical Set Design Studio</title>
  <meta name="description" content="botanical set design studio — seoul & paris" />
  <meta name="robots" content="index,follow" />
  <link rel="icon" type="image/png" href="/favicon.png" />

  <link rel="preconnect" href="https://esm.sh" crossorigin>
  <link rel="dns-prefetch" href="//esm.sh">
  <link rel="modulepreload" href="https://esm.sh/ogl@0.0.104">

  <link rel="preload" href="/fonts/MinionPro-Regular.otf" as="font" type="font/otf" crossorigin>
  <link rel="preload" href="/fonts/MinionPro-Bold.otf" as="font" type="font/otf" crossorigin>
  <link rel="preload" href="/fonts/MinionPro-It.otf" as="font" type="font/otf" crossorigin>

  <style>
    @font-face { font-family:"Minion Pro"; src:local("Minion Pro Regular"), local("MinionPro-Regular"), url("fonts/MinionPro-Regular.otf") format("opentype"); font-weight:400; font-style:normal; font-display: swap; }
    @font-face { font-family:"Minion Pro"; src:local("Minion Pro Bold"), local("MinionPro-Bold"), url("fonts/MinionPro-Bold.otf") format("opentype"); font-weight:700; font-style:normal; font-display: swap; }
    @font-face { font-family:"Minion Pro"; src:local("Minion Pro Italic"), local("MinionPro-It"), url("fonts/MinionPro-It.otf") format("opentype"); font-weight:400; font-style:italic; font-display: swap; }

    :root { --bg:#FDFAFA; --fg:#292929; }

    html, body {
      height:100%; 
      margin:0; 
      padding:0; 
      overflow:hidden;
      background:var(--bg); 
      color:var(--fg);
      font-family:"Minion Pro", serif; 
      letter-spacing:.01em;
      user-select: none;       /* ✅ empêche la sélection du texte */
      -webkit-user-select: none; /* pour Safari */
      -moz-user-select: none;    /* pour Firefox */
      -ms-user-select: none;     /* pour les vieux navigateurs */
    }

    /* === BACKGROUND PLASMA (derrière, fixe) === */
    #plasma-bg, .wrap, .footer { opacity: 0; }

    #plasma-bg { 
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      transition: opacity .6s ease;            /* plasma fade-in */
    }

    .wrap, .footer {
      position: relative; z-index: 1;
      transition: opacity .5s ease, transform .5s ease;
      transform: translateY(6px);               /* léger slide-up */
    }

    html.plasma-ready #plasma-bg { opacity: 1; }
    html.plasma-ready .wrap,
    html.plasma-ready .footer { opacity: 1; transform: none; }

    /* === CONTENU === */
    .wrap {
      position: relative; z-index: 1;
      height: 100%;
      display: flex; flex-direction: column;
      justify-content: center; align-items: center;
      text-align: center; padding: 2rem; box-sizing: border-box; line-height: 1.25;
    }

    .title  { font-size: clamp(58px, 10vw, 120px);; font-weight:700;}
    .kicker { font-size: clamp(15px, 2.5vw, 18px); font-style: italic; text-transform: lowercase; margin-top:-1.5em; }
    @media (max-width: 640px) {
      .kicker { margin-top: -1.1em; }
    }
    .desc   { font-size: clamp(15px, 2.5vw, 18px); font-weight:700; text-transform: uppercase; letter-spacing:.05em; margin-top:.1em; }
    .soon   {font-size: clamp(15px, 2.6vw, 20px); margin-top: 4em; }

    .footer {
      position: fixed; left:0; right:0; bottom: 2.5rem;
      z-index: 1; text-align:center; font-size:15px; letter-spacing:.08em;
    }
    .contact { font-size: clamp(15px, 2.6vw, 20px); text-transform: uppercase; margin-bottom:.4em; letter-spacing:0.12em;}
    .year { font-style: italic; opacity:.8; font-size:14px; }

    a {
      color: inherit;
      text-decoration: underline;
      text-underline-offset: 3px;
      text-decoration-thickness: 0.5px;
    }
  </style>
</head>
<body>
  <!-- Fond Plasma -->
  <div id="plasma-bg"></div>

  <!-- Contenu -->
  <main class="wrap">
    <div class="title">maison joo</div>
    <div class="kicker">seoul & paris</div>
    <div class="desc">botanical set design studio</div>
    <div class="soon">more coming soon</div>
  </main>

  <!-- Footer fixé en bas -->
  <div class="footer">
    <div class="contact"><a href="mailto:contact@maisonjoo.com">contact</a></div>
    <div class="year">2025</div>
  </div>

  <!-- Plasma vanilla avec OGL (ESM CDN) -->
  <script type="module">
    import { Renderer, Program, Mesh, Triangle } from "https://esm.sh/ogl@0.0.104";

    // Réglages ambiance
    const isMobile = window.innerWidth < 768;
    const reduceMotion = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const DPR = isMobile ? 1 : Math.min(window.devicePixelRatio || 1, 1.5);

    const COLOR_HEX = "#373737";
    const OPACITY   = isMobile ? 0.10 : 0.12;
    const SPEED     = isMobile ? 0.5  : 0.6;
    const SCALE     = 1.25;
    const MODE      = "pingpong";
    const MOUSE     = true;

    const hexToRgb = (hex) => {
      const m = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      if (!m) return [1,1,1];
      return [parseInt(m[1],16)/255, parseInt(m[2],16)/255, parseInt(m[3],16)/255];
    };

    const vertex = `#version 300 es
    precision highp float; in vec2 position; in vec2 uv; out vec2 vUv;
    void main(){ vUv=uv; gl_Position=vec4(position,0.,1.); }`;

    const fragment = `#version 300 es
    precision highp float;
    uniform vec2 iResolution; uniform float iTime;
    uniform vec3 uCustomColor; uniform float uUseCustomColor;
    uniform float uSpeed; uniform float uDirection; uniform float uScale;
    uniform float uOpacity; uniform vec2 uMouse; uniform float uMouseInteractive;
    out vec4 fragColor;
    void mainImage(out vec4 o, vec2 C){
      vec2 center=iResolution*.5; C=(C-center)/uScale+center;
      vec2 mouseOffset=(uMouse-center)*0.0002;
      C+=mouseOffset*length(C-center)*step(0.5,uMouseInteractive);
      float i,d,z,T=iTime*uSpeed*uDirection; vec3 O,p,S;
      for(vec2 r=iResolution.xy,Q; ++i<60.; O+=o.w/d*o.xyz){
        p=z*normalize(vec3(C-.5*r,r.y)); p.z-=4.; S=p; d=p.y-T;
        p.x+=.4*(1.+p.y)*sin(d+p.x*.1)*cos(.34*d+p.x*.05);
        Q=p.xz*=mat2(cos(p.y+vec4(0,11,33,0)-T));
        z+= d = abs(sqrt(length(Q*Q))-.25*(5.+S.y))/3.+8e-4;
        o = 1.+sin(S.y+p.z*.5+S.z-length(S-p)+vec4(2,1,0,8));
      } o.xyz=tanh(O/1e4);
    }
    bool finite1(float x){ return !(isnan(x)||isinf(x)); }
    vec3 sanitize(vec3 c){ return vec3(finite1(c.r)?c.r:0., finite1(c.g)?c.g:0., finite1(c.b)?c.b:0.); }
    void main(){
      vec4 o=vec4(0.); mainImage(o, gl_FragCoord.xy); vec3 rgb=sanitize(o.rgb);
      float intensity=(rgb.r+rgb.g+rgb.b)/3.; vec3 custom=intensity*uCustomColor;
      vec3 final=mix(rgb, custom, step(0.5,uUseCustomColor));
      float alpha=length(rgb)*uOpacity; fragColor=vec4(final, alpha);
    }`;

    const container = document.getElementById("plasma-bg");
    const renderer = new Renderer({
      webgl: 2,
      alpha: true,
      antialias: false,
      dpr: DPR
    });
    const gl = renderer.gl; const canvas = gl.canvas;
    canvas.style.cssText = "width:100%;height:100%;display:block;";
    container.appendChild(canvas);

    const geometry = new Triangle(gl);
    const program = new Program(gl, {
      vertex, fragment,
      uniforms:{
        iTime:{ value:0 },
        iResolution:{ value:new Float32Array([1,1]) },
        uCustomColor:{ value:new Float32Array(hexToRgb(COLOR_HEX)) },
        uUseCustomColor:{ value:1.0 },
        uSpeed:{ value:SPEED*0.4 },
        uDirection:{ value:1.0 },
        uScale:{ value:SCALE },
        uOpacity:{ value:OPACITY },
        uMouse:{ value:new Float32Array([0,0]) },
        uMouseInteractive:{ value: MOUSE?1.0:0.0 }
      }
    });
    const mesh = new Mesh(gl,{ geometry, program });

    const setSize = () => {
      const r = container.getBoundingClientRect();
      renderer.setSize(Math.max(1,r.width|0), Math.max(1,r.height|0));
      const res = program.uniforms.iResolution.value;
      res[0]=gl.drawingBufferWidth; res[1]=gl.drawingBufferHeight;
    };
    new ResizeObserver(setSize).observe(container); setSize();

    if (MOUSE) {
      container.addEventListener("mousemove", (e)=>{
        const rect = container.getBoundingClientRect();
        const u = program.uniforms.uMouse.value;
        u[0] = e.clientX - rect.left; u[1] = e.clientY - rect.top;
      });
    }

    let running = true;
    document.addEventListener('visibilitychange', () => {
      running = !document.hidden;
      if (running && !reduceMotion) requestAnimationFrame(loop);
    });

    let firstFrame = true;
    let last = 0;
    const targetDelta = 1000 / 30; // 30 fps
    const t0 = performance.now();

    const loop = (t) => {
      if (!running) return;
      if (t - last < targetDelta) { requestAnimationFrame(loop); return; }
      last = t;

      // pingpong doux
      const D = 10;
      const time = (t - t0) * 0.001;
      const seg = time % D;
      const forward = (Math.floor(time / D) % 2 === 0);
      const u = seg / D;
      const smooth = u * u * (3 - 2 * u);
      const tt = forward ? smooth * D : (1 - smooth) * D;
      program.uniforms.iTime.value = tt;

      renderer.render({ scene: mesh });

      if (firstFrame) {
        document.documentElement.classList.add('plasma-ready');
        firstFrame = false;
      }
      requestAnimationFrame(loop);
    };

    // ==== DÉMARRAGE ====
    if (reduceMotion) {
      renderer.render({ scene: mesh });               // 1 frame seulement
      document.documentElement.classList.add('plasma-ready');
    } else {
      requestAnimationFrame(loop);
    }
  </script>
</body>
</html>
